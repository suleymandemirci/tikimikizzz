const Discord = require('discord.js');
const client = new Discord.Client();
const ayarlar = require('./ayarlar.json');
const config = require('./config.json');
const chalk = require('chalk'); 
const yt = require('ytdl-core');
const fs = require('fs');
const moment = require('moment');
const GIFEncoder = require('gifencoder');
require('./util/eventLoader')(client);

var prefix = ayarlar.prefix;

const log = message => {
  console.log(`[${moment().format('-')}] ${message}`);
};

client.commands = new Discord.Collection();
client.aliases = new Discord.Collection();
fs.readdir('./komutlar/', (err, files) => {
  if (err) console.error(err);
  log(`${files.length} komut yÃ¼klenecek.`);
  files.forEach(f => {
    let props = require(`./komutlar/${f}`);
    log(`YÃ¼klenen komut: ${props.help.name}.`);
    client.commands.set(props.help.name, props);
    props.conf.aliases.forEach(alias => {
      client.aliases.set(alias, props.help.name);
    });
  });
});

client.reload = command => {
  return new Promise((resolve, reject) => {
    try {
      delete require.cache[require.resolve(`./komutlar/${command}`)];
      let cmd = require(`./komutlar/${command}`);
      client.commands.delete(command);
      client.aliases.forEach((cmd, alias) => {
        if (cmd === command) client.aliases.delete(alias);
      });
      client.commands.set(command, cmd);
      cmd.conf.aliases.forEach(alias => {
        client.aliases.set(alias, cmd.help.name);
      });
      resolve();
    } catch (e){
      reject(e);
    }
  });
};

client.load = command => {
  return new Promise((resolve, reject) => {
    try {
      let cmd = require(`./komutlar/${command}`);
      client.commands.set(command, cmd);
      cmd.conf.aliases.forEach(alias => {
        client.aliases.set(alias, cmd.help.name);
      });
      resolve();
    } catch (e){
      reject(e);
    }
  });
};

client.unload = command => {
  return new Promise((resolve, reject) => {
    try {
      delete require.cache[require.resolve(`./komutlar/${command}`)];
      let cmd = require(`./komutlar/${command}`);
      client.commands.delete(command);
      client.aliases.forEach((cmd, alias) => {
        if (cmd === command) client.aliases.delete(alias);
      });
      resolve();
    } catch (e){
      reject(e);
    }
  });
};

// BOTUN Ã–ZELÄ°NÄ° GÃ–RME // 

  client.on("message", message => {
    const dmchannel = client.channels.find("name", "crexdm");
    if (message.channel.type === "dm") {
        if (message.author.id === client.user.id) return;
        dmchannel.sendMessage("", {embed: {
                color: 3447003,
                title: `Yazan: ${message.author.tag}`,
                description: `${message.content}`
              }})
    }
    if (message.channel.bot) return;
});
 
client.on('guildCreate', guild => {
    const channel = guild.channels.find('name', 'sohbet');
    if (!channel) return;
    const embed = new Discord.RichEmbed()
    .setTitle(`Merhaba!,Ben best!`)
    .setDescription(`Beni eklediginiz iÃ§in teÅŸekkÃ¼r ederim.KomutlarÄ±mÄ± Ã¶ÄŸrenmek iÃ§in **s!yardÄ±m** yazabilirsin.`)
    channel.sendEmbed(embed);
    console.log(`Bot ${guild.name} adlÄ± sunucuya katÄ±ldÄ±! Sunucu sahibi: ${guild.owner}, sunucudaki Ã¼ye sayÄ±sÄ±: ${guild.memberCount}.`);
 });

client.on('guildCreate', guild => {
  const embed = new Discord.RichEmbed()
  .setColor('RANDOM')
  .setTitle('Bir Sunucuya KatÄ±ldÄ±m;')
  .setDescription(`Bot, **${guild.name}** adlÄ± sunucuya katÄ±ldÄ± ${guild.memberCount} **Ãœye!**`)
  .setTimestamp()
  client.channels.get('470187479673077761').send(embed);
});

client.on('guildDelete', guild => {
  const embed = new Discord.RichEmbed()
  .setColor('RANDOM')
  .setTitle('Bir Sunucudan AyrÄ±ldÄ±m;')
  .setDescription(`Bot, **${guild.name}** sunucudan ayrÄ±ldÄ± ${guild.memberCount} **Ãœye!**`)
  .setTimestamp()
  client.channels.get('470187479673077761').send(embed);
});

const Jimp = require('jimp');
var f = [];
 
client.on("guildMemberAdd", async member => {
  const channel = member.guild.channels.find('name', 'scary-log');//log ismini ayarlÄ±yacaksÄ±nÄ±z log adÄ±nda kanal aÃ§Ä±n
  if (!channel) return;
        let username = member.user.username;
        if (channel === undefined || channel === null) return;
        if (channel.type === "text") {
            const bg = await Jimp.read("https://cdn.discordapp.com/attachments/450693709076365323/473184528148725780/guildAdd.png");
            const userimg = await Jimp.read(member.user.avatarURL);
            var font;
            if (member.user.tag.length < 15) font = await Jimp.loadFont(Jimp.FONT_SANS_128_WHITE);
            else if (member.user.tag.length > 15) font = await Jimp.loadFont(Jimp.FONT_SANS_64_WHITE);
            else font = await Jimp.loadFont(Jimp.FONT_SANS_32_WHITE);
            await bg.print(font, 430, 170, member.user.tag);
            await userimg.resize(362, 362);
            await bg.composite(userimg, 43, 26).write("./img/"+ member.id + ".png");
              setTimeout(function () {
                    channel.send(new Discord.Attachment("./img/" + member.id + ".png"));
              }, 1000);
              setTimeout(function () {
                fs.unlink("./img/" + member.id + ".png");
              }, 10000);
        }
    })
    client.on("guildMemberRemove", async member => {
  const channel = member.guild.channels.find('name', 'scary-log');//log ismini ayarlÄ±yacaksÄ±nÄ±z log adÄ±nda kanal aÃ§Ä±n
  if (!channel) return;
        let username = member.user.username;
        if (channel === undefined || channel === null) return;
        if (channel.type === "text") {            
                        const bg = await Jimp.read("https://cdn.discordapp.com/attachments/450693709076365323/473184546477572107/guildRemove.png");
            const userimg = await Jimp.read(member.user.avatarURL);
            var font;
            if (member.user.tag.length < 15) font = await Jimp.loadFont(Jimp.FONT_SANS_128_WHITE);
            else if (member.user.tag.length > 15) font = await Jimp.loadFont(Jimp.FONT_SANS_64_WHITE);
            else font = await Jimp.loadFont(Jimp.FONT_SANS_32_WHITE);
            await bg.print(font, 430, 170, member.user.tag);
            await userimg.resize(362, 362);
            await bg.composite(userimg, 43, 26).write("./img/"+ member.id + ".png");
              setTimeout(function () {
                    channel.send(new Discord.Attachment("./img/" + member.id + ".png"));
              }, 1000);
              setTimeout(function () {
                fs.unlink("./img/" + member.id + ".png");
              }, 10000);
        }
    })


	

client.on('message', async msg => {
  if (msg.content.toLowerCase() === 'sa') {
    await msg.react('ğŸ‡¦');
    msg.react('ğŸ‡¸');
  }
});


client.on('message', async msg => {
    if (msg.content.toLowerCase() === prefix + "disco") {
    msg.channel.send("Disko Partizane" + client.emojis.find("name", "parti").toString())
   if (msg.channel.type === "dm") return;
  const renk = [
  'DEFAULT',
  'AQUA',
  'GREEN',
  'BLUE',
  'PURPLE',
  'GOLD',
  'ORANGE',
  'RED',
  'GREY',
  'DARKER_GREY',
  'NAVY',
  'DARK_AQUA',
  'DARK_GREEN',
  'DARK_BLUE',
  'DARK_PURPLE',
  'DARK_GOLD',
  'DARK_ORANGE',
  'DARK_RED',
  'DARK_GREY',
  'LIGHT_GREY',
  'DARK_NAVY',
  'BEÄ°GE'
];
  setInterval(function() {
        var random = Math.floor(Math.random()*(renk.length-0+1)+0);
      msg.guild.roles.find('name', "Disco").setColor(renk[random])
      }, 5000);
  }
});

client.on('message', message => {
    if (message.content.toLowerCase() === prefix + 'kedi') {
      message.channel.send("KediciÄŸi AyarlÄ±yorum 1 Dk CanÄ±m " + client.emojis.find("name", "loading").toString()).then(m => m.delete(1000));
var request = require('request');

request('http://aws.random.cat/meow', function (error, response, body) {
    if (error) return console.log('Hata:', error);
    else if (!error) { 
        var info = JSON.parse(body);
  const foto = new Discord.RichEmbed()
  .setImage(info.file)
      message.channel.send(foto)
      }
})
    }
});

client.on('message', message => {
    if (message.content.toLowerCase() === prefix + 'kÃ¶pek') {
      message.channel.send("KÃ¶peciÄŸi AyarlÄ±yorum 1 Dk CanÄ±m " + client.emojis.find("name", "loading").toString()).then(m => m.delete(1000));
var request = require('request');

request('https://random.dog/woof.json', function (error, response, body) {
    if (error) return console.log('Hata:', error);
    else if (!error) {
        var info = JSON.parse(body);
  const foto = new Discord.RichEmbed()
  .setImage(info.url)
      message.channel.send(foto)
    }
})
    }
});

client.on('message', message => {
if (message.content.toLowerCase() === prefix + "zekam") {
    var sans = ["11", "15", "20", "24", "28", "31", "39", "45", "49", "54", "58", "63", "67", "77", "73", "84", "80", "83", "96", "94", "99", "Albert Einstein mÄ±sÄ±n krdÅŸm"];
    var sonuc = sans[Math.floor((Math.random() * sans.length))];
    const embed = new Discord.RichEmbed()
    .setAuthor(message.author.username, message.author.avatarURL)
    .addField(`Zekan`, `${sonuc}`)
    return message.channel.sendEmbed(embed);
}
});

client.on('message', async message => {
    if (message.content.toLowerCase() === prefix + 'dÃ¶viz') {
var request = require('request');
request('https://www.doviz.com/api/v1/currencies/USD/latest', function (error, response, body) {
    if (error) return console.log('Hata:', error);
    else if (!error) { 
        var info = JSON.parse(body);
request('https://www.doviz.com/api/v1/currencies/EUR/latest', function (error, response, body) {
    if (error) return console.log('Hata:', error); 
    else if (!error) { 
				var euro = JSON.parse(body);
				message.channel.sendEmbed(new Discord.RichEmbed()
				.setAuthor('Dolar Ve Euro', 'http://www.doviz724.com/images/dolar-sosyal.png')
				.setColor('RANDOM')
				.setDescription(``)
				.addField('Dolar SatÄ±ÅŸ:', '' + `${info.selling}` + '')
				.addField('Dolar AlÄ±ÅŸ:', '' + `${info.buying}` + '')
				.addField('Euro SatÄ±ÅŸ:', '' + `${euro.selling}` + '')
				.addField('Euro AlÄ±ÅŸ:', '' + `${euro.buying}` + '')); }
})
    }
})
    }
});

client.on('message', message => {
  if (!message.guild) return;

  if (message.content === '++gir') {
    if (message.member.voiceChannel) {
      message.member.voiceChannel.join()
        .then(connection => { 
          message.reply('Kanala baÅŸarÄ±lÄ± bir ÅŸekilde baÄŸlandÄ±m!');
        })
        .catch(console.log);
    } else {
      message.reply('Ã–nce bir ses kanalÄ±na katÄ±lmalÄ±sÄ±n!');
    }
  }
});

client.on("message", async message => {
  var user = message.mentions.users.first() || message.author;
    if (message.content.toLowerCase() === prefix + "wasted") {
      message.channel.startTyping();
        var user = message.mentions.users.first() || message.author;
        if (!message.guild) user = message.author;

        Jimp.read(user.avatarURL, (err, image) => {
            image.resize(295, 295)
            image.greyscale()
            image.gaussian(3)
            Jimp.read("https://cdn.glitch.com/b18a2fa6-68cb-49d5-9818-64c50dd0fdab%2F1.png?1529363616039", (err, avatar) => {
                avatar.resize(295, 295)
                image.composite(avatar, 4, 0).write(`./img/wasted/${client.user.id}-${user.id}.png`);
                setTimeout(function() {
                    message.channel.send(new Discord.Attachment(`./img/wasted/${client.user.id}-${user.id}.png`));
                }, 1000);
          message.channel.stopTyping();
            });
        });
    }
});

client.on("message", async message => {
  var user = message.mentions.users.first() || message.author;
    if (message.content.toLowerCase() === prefix + "trigger") {
        const options = {
            size: 256,
          
            frames: 16
        }

        message.channel.send("Ä°ÅŸleniyor.. LÃ¼tfen bekleyiniz. â²").then(m => m.delete(1000));

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        const args = message.content.split(' ').slice(1);
        let member = message.mentions.users.first()
        if (args[0] === undefined) member = message.author;
        let avatarurl = member.avatarURL;
        if (['jpg', 'jpeg', 'gif', 'png', 'webp'].some(x => args.join(' ').includes(x))) {
            avatarurl = args.join(' ').replace(/gif|webp/g, 'png');
        }
        const base = new Jimp(options.size, options.size);
        const avatar = await Jimp.read(avatarurl);
        const text = await Jimp.read('https://cdn.glitch.com/a7d3b6b8-9b7a-4aab-9ee4-1db0c07ef1eb%2Ftriggered.png?1526842782410');
        const tint = await Jimp.read('https://cdn.glitch.com/5fed2789-b430-43c5-bf1b-a8dd32d46b97%2Fred.png?1527082445373');
        avatar.resize(320, 320);
        tint.scaleToFit(base.bitmap.width, base.bitmap.height);
        tint.opacity(0.2);
        text.scaleToFit(280, 60);
        const frames = [];
        const buffers = [];
        const encoder = new GIFEncoder(options.size, options.size);
        const stream = encoder.createReadStream();
        let temp;
        stream.on('data', async buffer => await buffers.push(buffer));
        stream.on('end', async () => {
            return await message.channel.send({
                files: [{
                    name: 'notechtriggered.gif',
                    attachment: Buffer.concat(buffers)
                }]
            });
        });
        for (let i = 0; i < options.frames; i++) {
            temp = base.clone();
            if (i === 0) {
                temp.composite(avatar, -16, -16);
            } else {
                temp.composite(avatar, -32 + getRandomInt(-16, 16), -32 + getRandomInt(-16, 16));
            }
            temp.composite(tint, 0, 0);
            if (i === 0) temp.composite(text, -10, 200);
            else temp.composite(text, -12 + getRandomInt(-8, 8), 200 + getRandomInt(-0, 12));
            frames.push(temp.bitmap.data);
        }
        encoder.start();
        encoder.setRepeat(0);
        encoder.setDelay(20);
        for (const frame of frames) {
            encoder.addFrame(frame);
        }
        encoder.finish();
    }
});

client.on("message", async message => {
  if(message.author.bot) return;
  if(message.content.indexOf(prefix) !== 0) return;

  const args = message.content.slice(config.prefix.length).trim().split(/ +/g);
  const command = args.shift().toLowerCase();
 
  if(command === "yasakla") {
    if(!message.member.roles.some(r=>["Admin"].includes(r.name)) )
      return message.reply("ÃœzgÃ¼nÃ¼m, **Admin** rolÃ¼ne sahip olmalÄ±sÄ±n.");
    
    let member = message.mentions.members.first();
    if(!member)
      return message.reply("Sunucudan yasaklayacaÄŸÄ±m kiÅŸiyi etiketlemelisin.");
    if(!member.bannable) 
      return message.reply("Sunucudan yasaklayamadÄ±m. Yoksa bana sunucudan atma yetkisi vermedin mi? veya bana yetkiliyi mi yasaklamaya Ã§alÄ±ÅŸtÄ±rdÄ±n?");

    let reason = args.slice(1).join(' ');
    if(!reason) reason = "AÃ§Ä±klama yok mu?";
    
    await member.ban(reason)
      .catch(error => message.reply(`ÃœzgÃ¼nÃ¼m sunucudan yasaklayamadÄ±m. HATA: ${error}`));
    message.channel.sendMessage(`${message.author.tag} sunucudan ${member.user.tag} kiÅŸisini yasakladÄ±. AÃ§Ä±klama: ${reason}`);
  }
  });

client.on("message", async message => {
  if(message.author.bot) return;
  if(message.content.indexOf(prefix) !== 0) return;

  const args = message.content.slice(config.prefix.length).trim().split(/ +/g);
  const command = args.shift().toLowerCase();
 
 if(command === "at") {
    if(!message.member.roles.some(r=>["Admin", "Moderator"].includes(r.name)) )
      return message.reply("ÃœzgÃ¼nÃ¼m, **Admin** veya **Moderator** rolÃ¼ne sahip olmalÄ±sÄ±n.");
    
    let member = message.mentions.members.first() || message.guild.members.get(args[0]);
    if(!member)
      return message.reply("Sunucudan atacaÄŸÄ±m kiÅŸi etiketlemelisin.");
    if(!member.kickable) 
      return message.reply("Sunucudan atamadÄ±m. Yoksa bana sunucudan atma yetkisi vermedin mi? veya bana yetkiliyi mi atmaya Ã§alÄ±ÅŸtÄ±rdÄ±n?");
    
    let reason = args.slice(1).join(' ');
    if(!reason) reason = "AÃ§Ä±klama yok mu?";
    
    await member.kick(reason)
      .catch(error => message.reply(`ÃœzgÃ¼nÃ¼m sunucudan atamadÄ±m. HATA: ${error}`));
    message.channel.sendMessage(`${message.author.tag} sunucudan ${member.user.tag} kiÅŸisini attÄ±. AÃ§Ä±klama: ${reason}`);

  }
  });

client.on("message", async message => {
    const args = message.content.substring(prefix.length).split(" ");
    const command = args.shift().toLowerCase();
    if (command === "vaporwave") {
        const mapping = 'Â¡"#$%â…‹,)(*+\'-Ë™/0Æ–á„…Æã„£Ï›9ã„¥86:;<=>Â¿@ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼º[/]^_`ï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½š{|}~';
        const OFFSET = '!'.charCodeAt(0);
        if (args.length < 1) {
            message.channel.send('Estetik yazÄ±lacak yazÄ±yÄ± yazmalÄ±sÄ±n.');
        }

        message.channel.send(
            args.join(' ').split('')
            .map(c => c.charCodeAt(0) - OFFSET)
            .map(c => mapping[c] || ' ')
            .join('')
        )
    }
});

client.on("message", async message => {
  var user = message.mentions.users.first() || message.author;
    if (message.content.toLowerCase() === prefix + "sniper") {
        var user = message.mentions.users.first() || message.author;
        if (!message.guild) user = message.author;

        message.channel.send("Ä°ÅŸleniyor.. LÃ¼tfen bekleyiniz. â²").then(m => m.delete(1000));

        Jimp.read(user.avatarURL, (err, image) => {
            image.resize(310, 325)
            image.greyscale()
            image.gaussian(3)
            Jimp.read("https://cdn.glitch.com/b18a2fa6-68cb-49d5-9818-64c50dd0fdab%2FPNGPIX-COM-Crosshair-PNG-Transparent-Image.png?1529363625811", (err, avatar) => {
                avatar.resize(310, 325)
                image.composite(avatar, 2, 0).write(`./img/snip/${client.user.id}-${user.id}.png`);
                setTimeout(function() {
                    message.channel.send(new Discord.Attachment(`./img/snip/${client.user.id}-${user.id}.png`));
                }, 1000);
            });

        });
    }
});

client.on("message", async message => {
  var user = message.mentions.users.first() || message.author;
    if (message.content.toLowerCase() === prefix + "kullanÄ±cÄ±bilgim") {
        const Durum = user.presence.status;
        const Durm = (Durum == "online" ? (0x00AE86) : (Durum == "offline" ? (0x808080) : (Durum == "idle" ? (0xFFFF00) : (Durum == "dnd" ? (0xFF0000) : (0x00AE86)))))
        const durm = (Durum == "online" ? ("Ã‡evrimiÃ§i") : (Durum == "offline" ? ("Ã‡evrimdÄ±ÅŸÄ±") : (Durum == "idle" ? ("BoÅŸta") : (Durum == "dnd" ? ("RahatsÄ±z Etmeyin") : ("Bilinmiyor/bulunamadÄ±.")))))
      const embed = new Discord.RichEmbed()
      .setColor(Durm)
      .addField("Ä°sim ve ID", `${user.tag}, (${user.id})`, false)
      .addField("KayÄ±t Tarihi", `${user.createdAt}`, false)
      .addField("Durum", `${durm}`, false)
      .addField("OynadÄ±ÄŸÄ± Oyun", `${user.presence.game ? user.presence.game.name : 'OynamÄ±yor'}`, false)
      .addField("Bot mu?", `${user.bot ? '\n Evet' : 'HayÄ±r'}`, false)
      .setThumbnail(user.avatarURL)
      message.channel.send(embed)
    }
});

client.on("message", message => {
    if (message.content.toLowerCase() === prefix + "sunucubilgi") {
        const embed = new Discord.RichEmbed()
    .setTimestamp()
    .setAuthor(message.guild.name, message.guild.iconURL)
    .addField('Sunucu AdÄ±:', message.guild.name)
    .addField('Sunucu ID:', message.guild.id)
    .addField('Ana kanal:', message.guild.defaultChannel)
    .addField('Sunucu BÃ¶lgesi:', message.guild.region)
    .addField('Ãœye sayÄ±sÄ±:', message.guild.memberCount)
    .addField('Sahibi:', message.guild.owner + ' (' + message.guild.ownerID + ')')
    .addField('Kanal sayÄ±sÄ±:', message.guild.channels.size)
    .addField('OluÅŸturulma tarihi:', message.guild.createdAt)
    .setColor("RANDOM")

        return message.channel.sendEmbed(embed)
    }
});

client.on("message", async message => {
  if(message.author.bot) return;
  if(message.content.indexOf(prefix) !== 0) return;

  const args = message.content.slice(config.prefix.length).trim().split(/ +/g);
  const command = args.shift().toLowerCase();

    if (command === "temizle") {
        const user = message.mentions.users.first();
        if (!message.member.hasPermission('MANAGE_MESSAGES')) return message.channel.send('ÃœzgÃ¼nÃ¼m, mesajlarÄ± silecek veya temizleyecek yetkin yok!')
            .then(msg => msg.delete({
                timeout: 10000
            }));
        const amount = !!parseInt(message.content.split(' ')[1]) ? parseInt(message.content.split(' ')[1]) : parseInt(message.content.split(' ')[2])
        if (!amount) return message.channel.send('Silinecek veya temizlenecek mesaj sayÄ±sÄ±nÄ± giriniz!')
            .then(msg => msg.delete({
                timeout: 10000
            }));
        if (!amount && !user) return message.channel.send('Bir kullanÄ±cÄ± ve mesaj sayÄ±sÄ± giriniz, ya da sadece silinecek mesaj sayÄ±sÄ±!')
            .then(msg => msg.delete({
                timeout: 10000
            }));
        message.channel.fetchMessages({
                limit: amount,
            })
            .then((messages) => {
                if (user) {
                    const filterBy = user ? user.id : client.user.id;
                    messages = messages.filter(m => m.author.id === filterBy)
                        .array()
                        .slice(0, amount);
                }
                message.channel.bulkDelete(messages)
                    .catch(error => console.log(error.stack));
            });
    }
  });

client.on("message", message => {
  if (message.content.toLowerCase() === prefix + 'reboot') {
  if (message.author.id !== "461991104569671697") {
    message.reply(':no_entry: ÃœzgÃ¼nÃ¼m ama `reboot` komutunu kullanmak iÃ§in gerekli izne sahip deÄŸilsin.');
  } else {
    message.channel.sendMessage(`Bot yeniden baÅŸlatÄ±lÄ±yor`).then(msg => {
    console.log(`BOT: Bot yeniden baÅŸlatÄ±lÄ±yor...`);
    process.exit(0);
  })
 }
}
});
// EVAL KOD DENEMEK Ä°Ã‡Ä°N KULLANILIR // 
const clean = text => {
  if (typeof(text) === "string")
    return text.replace(/`/g, "`" + String.fromCharCode(8203)).replace(/@/g, "@" + String.fromCharCode(8203));
  else
      return text;
}

client.on("message", message => {
  const args = message.content.split(" ").slice(1);

  if (message.content.startsWith(prefix + "eval")) {
    if(message.author.id !== "432956416949485568") return;
    try {
      const code = args.join(" ");
      let evaled = eval(code);

      if (typeof evaled !== "string")
        evaled = require("util").inspect(evaled);

      message.channel.send(clean(evaled), {code:"xl"});
    } catch (err) {
      message.channel.send(`\`HATA\` \`\`\`xl\n${clean(err)}\n\`\`\``);
    }
  }
});
client.on('message', message => {
  if (message.author.bot) return;
  if (message.channel.type !== 'text') return;
  if (message.author.bot) return;
  if (!message.content.startsWith(prefix)) return;
  let command = message.content.split(' ')[0];
  command = command.slice(prefix.length);
  let args = message.content.split(' ').slice(1);
  let cont = message.content.slice(prefix.length).split(' ');
  let args2 = cont.slice(1);
  
  if (command === 'resim-deÄŸiÅŸtir') {
    if(message.author.id !== '462746070582165535') 
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Resim deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu yalnÄ±zca yapÄ±mcÄ±m kullanabilir.').setFooter('Funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Resim deÄŸiÅŸtir;').setDescription(message.author.username + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('Funish', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Resim deÄŸiÅŸtir;').setDescription(message.author.tag + ', kullanÄ±m: s!resim-deÄŸiÅŸtir <baÄŸlantÄ±>.').setFooter('Funish', client.user.avatarURL).setTimestamp());
    client.user.setAvatar(sayMessage);
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Resim deÄŸiÅŸtir;')
    .setDescription(message.author.tag + ', profil resmim baÅŸarÄ±yla deÄŸiÅŸtirildi.')
    .setFooter('Funish', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  if (command === 'Ã§eviri') {
    var translate = require('node-google-translate-skidz');
    let targetLang = args[0];
    if(!targetLang) return message.channel.send(":no_entry_sign: Ne yazacaÄŸÄ±nÄ± demelisin **s!translate tr merhaba** gibi.");
    if(targetLang.length > 2) return message.channel.send(":no_entry_sign: LÃ¼tfen bir dil gir **tr, en** gibisinden.");
    var translateText = args.slice(1).join(" ");
    if(!translateText) return message.channel.send(`:no_entry_sign: Ã‡evirmek istediÄŸiniz "${targetLang}" dili yazÄ±n..`);

    translate({
      text: translateText,
      target: targetLang
    }, function(result) {
      var translatedText = result.translation
      const embed = new Discord.RichEmbed()
      .setAuthor(`Ã‡eviri`, message.author.avatarURL)
      .setColor(0x00AE86)
      .addField("Mesaj:", "**" + translateText + "**")
      .addField(`Ã‡evrilen Mesaj: ${targetLang}`, "**" + translatedText + "**")
      .setFooter(`${message.author.tag} tarafÄ±ndan istendi!`, client.user.avatarURL)
      message.channel.send({embed})
        .catch(error => message.channel.send(`ÃœzgÃ¼nÃ¼m ${message.author.tag} Sana embed ÅŸeklinde yollayamÄ±yorum: ${error}`))
    });
  }
  if (command === 'durum') {
    if(message.author.id !== '461991104569671697') 
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Durum deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu yalnÄ±zca yapÄ±mcÄ±m kullanabilir.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Durum deÄŸiÅŸtir;').setDescription(message.author.username + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Durum deÄŸiÅŸtir;').setDescription(message.author.tag + ', kullanÄ±m: s!durum-deÄŸiÅŸtir <durum>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    client.user.setStatus(sayMessage);
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Durum deÄŸiÅŸtir;')
    .setDescription(message.author.tag + ', durumum baÅŸarÄ±yla deÄŸiÅŸtirildi.')
    .setFooter('Scary', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  
  if (command === 'aktivite') {
    if(message.author.id !== '461991104569671697') 
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Aktivite deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu yalnÄ±zca yapÄ±mcÄ±m kullanabilir.').setFooter('Scary', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Aktivite deÄŸiï¿½ï¿½tir;').setDescription(message.author.username + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('Scary', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Aktivite deÄŸiÅŸtir;').setDescription(message.author.tag + ', kullanÄ±m: s!aktivite-deÄŸiÅŸtir <mesaj>.').setFooter('Scary', client.user.avatarURL).setTimestamp());
    client.user.setActivity(sayMessage);
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Aktivite deÄŸiÅŸtir;')
    .setDescription(message.author.tag + ', aktivitem baÅŸarÄ±yla deÄŸiÅŸtirildi.')
    .setFooter('funish', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  
  if (command === 'baÄŸlantÄ±lar' || command === 'linkler') {
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('BaÄŸlantÄ±lar;')
    .addField('Facebook:', 'https://www.facebook.com/#', true)
    .addField('YouTube:', 'https://www.youtube.com/channel/#', true)
    .addField('Twitter:', 'https://twitter.com/#', true)
    .addField('Ä°nstagram:', 'https://www.instagram.com/#', true)
    .addField('Twitch:', 'https://www.twitch.tv/cansuoztrk', true)
    .addField('Steam:', 'http://steamcommunity.com/profiles/#', true)
    .setFooter('funish', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  
  if (command === 'sunucular' || command === 'bot-sunucu') {
    const guildArray = client.guilds.array()
    while (guildArray.length) {
    const embed = new Discord.RichEmbed();
    const guilds = guildArray.splice(0,25);
    for (const guild of guilds) {
      embed.setColor('RANDOM')
      embed.setTitle('Sunucular;')
      embed.setDescription(`Åu an ${client.guilds.size} sunucuda bulunuyorum.`)
      embed.addField(guild.name, guild.memberCount + ' Ã¼ye.', true)
      embed.setFooter('Scary', client.user.avatarURL)
      embed.setTimestamp()
    }
    message.channel.send({embed: embed});
    
        };
  }
  //if (command === 'profil' || command === 'profile') {
    //if (!message.guild) {
      //return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Eval;').setDescription(message.author.username + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
  //et user = message.mentions.users.first();
   // if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Profil;').setDescription(message.author.tag + ', kullanÄ±m: tr!profil <@kullanÄ±cÄ±>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    //(`SELECT * FROM scores WHERE userId ="${user.id}"`).then(row => {
      //if (!row) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Profil;').setDescription(message.author.tag + ', hiÃ§ puanÄ± yok.').setFooter('funish', client.user.avatarURL));

    //const embed = new Discord.RichEmbed()
    //.setColor('RANDOM')
    //.setAuthor(user.tag, user.avatarURL || user.defaultAvatarURL)
    //.setThumbnail(user.avatarURL || user.defaultAvatarURL)
    //.setTitle('Profil;')
    //.addField('Puan:', row.points, true)
    //.addField('Seviye:', row.level, true)
    //.setFooter('Scary', client.user.avatarURL)
    //.setTimestamp()
    //message.channel.send(embed);
    // })
   //}
  
  if (command === 'para') {
    if(message.author.id !== '461991104569671697') 
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('YapÄ±mcÄ± para;').setDescription(message.author.tag + ', bu komutu yalnÄ±zca yapÄ±mcÄ±m kullanabilir.').setFooter('funish', client.user.avatarURL).setTimestamp());
      if (!message.guild) {
      return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Eval;').setDescription(message.author.username + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
      if(message.author.id === '461991104569671697') {
    } else {
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('YapÄ±mcÄ± para;')
    .setDescription(message.author.tag + ', bu komutu yalnÄ±zca yapÄ±mcÄ±m kullanabilir.')
    .setFooter('Scary', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
   }
  }
  if (command === 'maden') {
    let sayÄ±lar = Math.floor(Math.random() * 50)
    message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazma iÅŸi baÅŸladÄ±!').setFooter('funish', client.user.avatarURL).setTimestamp())
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazÄ±lÄ±yor %25.').setFooter('funish', client.user.avatarURL).setTimestamp()))
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazÄ±lÄ±yor %50.').setFooter('funish', client.user.avatarURL).setTimestamp()))
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazÄ±lÄ±yor %75.').setFooter('funish', client.user.avatarURL).setTimestamp()))
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazÄ±lÄ±yor %100.').setFooter('funish', client.user.avatarURL).setTimestamp()))
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', maden kazma iÅŸi bitti!').setFooter('funish', client.user.avatarURL).setTimestamp()))
      .then(nmsg => nmsg.edit(new Discord.RichEmbed().setColor('RANDOM').setTitle('Maden;').setDescription(message.author.tag + ', madenden ' + sayÄ±lar + ' â‚º kazandÄ±n!').setFooter('funish', client.user.avatarURL).setTimestamp()))
        };
  
  if (command === 'kullanÄ±cÄ±' || command === 'kullanÄ±cÄ±-bilgi') {
    let user = message.mentions.users.first();
    if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setAuthor(message.author.tag, message.author.avatarURL || message.author.defaultAvatarURL).setThumbnail(message.author.avatarURL || message.author.defaultAvatarURL).setTitle('KullanÄ±cÄ±;').addField('Oyun:', message.author.presence.game ? message.author.presence.game.name : 'Oyun oynamÄ±yor', true).addField('Kimlik:', message.author.id, true).addField('Bot:', message.author.bot ? '\n Evet' : 'HayÄ±r', true).addField('Rolleri:', message.guild.member(message.author).roles.map(m => m.name).join(' | '), true).addField('Son gÃ¶nderdiÄŸi mesaj:', message.author.lastMessage || 'Yok', true).addField('Son gÃ¶nderdiÄŸi mesajÄ±n kimliÄŸi:',message.author.lastMessageID || 'Yok', true).addField('OluÅŸturma tarihi:', message.author.createdAt.toLocaleDateString(), true).setFooter('funish', client.user.avatarURL).setTimestamp());
      const embed = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setAuthor(user.tag, user.avatarURL || user.defaultAvatarURL)
      .setThumbnail(user.avatarURL || user.defaultAvatarURL)
      .setTitle('KullanÄ±cÄ±;')
      .addField('Oyun:', user.presence.game ? user.presence.game.name : 'Oyun oynamÄ±yor', true)
      .addField('Kimlik:', user.id, true)
      .addField('Bot:', user.bot ? '\n Evet' : 'HayÄ±r', true)
      .addField('Rolleri:', message.guild.member(user).roles.map(m => m.name).join(' | '), true)
      .addField('Son gÃ¶nderdiÄŸi mesaj:', user.lastMessage || 'Yok', true)
      .addField('Son gÃ¶nderdiÄŸi mesajÄ±n kimliÄŸi:', user.lastMessageID || 'Yok', true)
      .addField('OluÅŸturma tarihi:', user.createdAt.toLocaleDateString(), true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
      message.channel.send(embed);
        };
  
  if (command === 'profil-resmi' || command === 'pp' || command === 'avatar') {
    let user = message.mentions.users.first();
    if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Profil resmi;').setImage(message.author.avatarURL || message.author.defaultAvatarURL).setFooter('funish', client.user.avatarURL).setTimestamp());
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Profil resmi;')
    .setImage(user.avatarURL || user.defaultAvatarURL)
    .setFooter('Scary', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  

  if (command === 'sunucuu' || command === 'sunucu-bilgii') {
    const emojiList = message.guild.emojis.map(e=>e.toString()).join(' ');
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setAuthor(message.guild.name, message.guild.iconURL)
    .setThumbnail(message.guild.iconURL)
    .setTitle('Sunucu;')
    .addField('Ä°sim kÄ±saltmasÄ±:', message.guild.nameAcronym, true)
    .addField('KimliÄŸi:', message.guild.id, true)
    .addField('BÃ¶lgesi:', message.guild.region, true)
    .addField('Sahibi:', message.guild.owner, true)
    .addField('DoÄŸrulama seviyesi:', message.guild.verificationLevel, true)
    .addField('Emojiler:', emojiList || 'Yok', true)
    .addField('Ãœyeler:', `${message.guild.members.filter(member => member.user.bot).size} bot / ${message.guild.memberCount} Ã¼ye`, true)
    .addField('VarsayÄ±lan rol:', message.guild.defaultRole, true)
    .addField('Roller:', message.guild.roles.map(role => role.name).join(' | '), true)
    .addField('Kanallar:', `${message.guild.channels.filter(chan => chan.type === 'voice').size} sesli / ${message.guild.channels.filter(chan => chan.type === 'text').size} metin`, true)
    .addField('Kanal sayÄ±sÄ±:', message.guild.channels.size, true)
    .addField('Ana kanalÄ±:', message.guild.defaultChannel || 'Yok', true)
    .addField('Sistem kanalÄ±:', message.guild.generalChannel || 'Yok', true)
    .addField('AFK kanalÄ±:', message.guild.afkChannel || 'Yok', true)
    .addField('AFK zaman aÅŸÄ±mÄ±:', message.guild.afkTimeout + ' saniye', true)
    .addField('OluÅŸturma tarihi:', message.guild.createdAt.toLocaleDateString(), true)
    .setFooter('Scary', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };
  
  if (command === 'att' || command === 'kickk') {
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('At;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    let guild = message.guild
    let reason = args.slice(1).join(' ');
    let user = message.mentions.users.first();
    let modlog = guild.channels.find('name', 'funish');
    if (!modlog) return message.guild.createChannel('funish');
    if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('At;').setDescription(message.author.tag + ', kullanÄ±m: tr!at <@kullanÄ±cÄ±> <sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (reason.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('At;').setDescription(message.author.tag + ', kullanÄ±m: tr!at <@kullanÄ±cÄ±> sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());

    if (!message.guild.member(user).kickable) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('At;').setDescription(message.author.tag + ', yetkilileri atamam.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.guild.member(user).kick();

    const embed = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Sunucudan atÄ±ldÄ±n;')
      .setDescription(message.guild.name + ' adlÄ± sunucudan atÄ±ldÄ±n.')
      .addField('Yetkili:', message.author.tag, true)
      .addField('Sebep:', reason, true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    user.send(embed);
    const embed2 = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('At;')
      .setDescription(user.tag + ' adlÄ± kullanÄ±cÄ± baÅŸarÄ±yla atÄ±ldÄ±.')
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    message.channel.send(embed2);
    const embed3 = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('At;')
      .addField('KullanÄ±cÄ±:', user.tag, true)
      .addField('Yetkili:', message.author.tag, true)
      .addField('Sebep:', reason, true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    return guild.channels.get(modlog.id).send(embed3);
        };

  if (command === 'yasaklaa' || command === 'bann') {
    if (!message.member.permissions.has('BAN_MEMBERS')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Yasakla;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Yasakla;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    let guild = message.guild
    let reason = args.slice(1).join(' ');
    let user = message.mentions.users.first();
    let modlog = guild.channels.find('name', 'funish');
    if (!modlog) return message.guild.createChannel('funish');
    if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Yasakla;').setDescription(message.author.tag + ', kullanÄ±m: tr!yasakla <@kullanÄ±cÄ±> <sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (reason.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Yasakla;').setDescription(message.author.tag + ', kullanÄ±m: tr!yasakla <@kullanÄ±cÄ±> <sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());

    if (!message.guild.member(user).bannable) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Yasakla;').setDescription(message.author.tag + ', yetkilileri yasaklayamam.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.guild.ban(user, 2);

    const embed = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Sunucudan yasaklandÄ±n;')
      .setDescription(message.guild.name + ' adlÄ± sunucudan yasaklandÄ±n.')
      .addField('Yetkili:', `${message.author.tag}`, true)
      .addField('Sebep:', reason, true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    user.send(embed);
    const embed2 = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Yasakla;')
      .setDescription(user.tag + ' adlÄ± kullanÄ±cÄ± baÅŸarÄ±yla yasaklandÄ±.')
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    message.channel.send(embed2);
    const embed3 = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Yasakla;')
      .addField('KullanÄ±cÄ±:', `${user.tag}`, true)
      .addField('Yetkili:', `${message.author.tag}`, true)
      .addField('Sebep:', reason, true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    return guild.channels.get(modlog.id).send(embed3);
        };

  if (command === 'uyar') {
    if (!message.member.permissions.has('KICK_MEMBERS')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Uyar;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Uyar;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
      let guild = message.guild
      let reason = args.slice(1).join(' ');
      let user = message.mentions.users.first();
      let modlog = guild.channels.find('name', 'funish');
      if (!modlog) return message.guild.createChannel('funish');
      if (message.mentions.users.size < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Uyar;').setDescription(message.author.tag + ', kullanÄ±m: tr!uyar <@kullanÄ±cÄ±> <sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());
      if (reason.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Uyar;').setDescription(message.author.tag + ', kullanÄ±m: tr!uyar <@kullanÄ±cÄ±> <sebep>.').setFooter('funish', client.user.avatarURL).setTimestamp());

      const embed = new Discord.RichEmbed()
        .setColor('RANDOM')
        .setTitle('Sunucuda uyarÄ±ldÄ±n;')
        .setDescription(message.guild.name + ' adlÄ± sunucuda uyarÄ±ldÄ±n.')
        .addField('Yetkili:', message.author.tag, true)
        .addField('Sebep:', reason, true)
        .setFooter('funish', client.user.avatarURL)
        .setTimestamp()
      user.send(embed);
      const embed2 = new Discord.RichEmbed()
        .setColor('RANDOM')
        .setTitle('Uyar;')
        .setDescription(user.tag + ' adlÄ± kullanÄ±cÄ± baÅŸarÄ±yla uyarÄ±ldÄ±.')
        .setFooter('funish', client.user.avatarURL)
        .setTimestamp()
      message.channel.send(embed2);
      const embed3 = new Discord.RichEmbed()
        .setColor('RANDOM')
        .setTitle('Uyar;')
        .addField('KullanÄ±cÄ±:', user.tag, true)
        .addField('Yetkili:', message.author.tag, true)
        .addField('Sebep:', reason, true)
        .setFooter('funish', client.user.avatarURL)
        .setTimestamp()
      return guild.channels.get(modlog.id).send(embed3)
        };
  
  if (command === 'sil') {
    if (!message.member.permissions.has('MANAGE_MESSAGES')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sil;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sil;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    let guild = message.guild
    let modlog = guild.channels.find('name', 'funish');
    if (!modlog) return message.guild.createChannel('funish');
    let mesajsayisi = parseInt(args.join(' '));
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sil;').setDescription(message.author.tag + ', kullanÄ±m: tr!sil <sayÄ±>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (mesajsayisi > 100) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sil;').setDescription(message.author.tag + ', 100 adetden fazla mesaj silemem.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.channel.bulkDelete(mesajsayisi + 1);
    const embed = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Sil;')
      .setDescription(message.author.tag + ', mesajlarÄ± baÅŸarÄ±yla sildim.')
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    message.channel.send(embed);
    const embed2 = new Discord.RichEmbed()
      .setColor('RANDOM')
      .setTitle('Sil;')
      .addField('Yetkili:', message.author.tag, true)
      .addField('Kanal:', message.channel.name, true)
      .addField('Mesaj sayÄ±sÄ±:', mesajsayisi, true)
      .setFooter('funish', client.user.avatarURL)
      .setTimestamp()
    return guild.channels.get(modlog.id).send(embed2)
    message.delete()
        };
  
  if (command === 'sunucu-adÄ±-deÄŸiÅŸtir') {
    if (!message.member.permissions.has('ADMINISTRATOR')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu adÄ± deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu adÄ± deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu adÄ± deÄŸiÅŸtir;').setDescription(message.author.tag + ', kullanÄ±m: tr!sunucu-adÄ±-deÄŸiÅŸtir <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.guild.setName(sayMessage);
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Sunucu adÄ± deÄŸiÅŸtir;')
    .setDescription(message.author.tag + ', sunucu adÄ± baÅŸarÄ±yla deÄŸiÅŸtirildi.')
    .setFooter('funish', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };

  if (command === 'sunucu-resmi-deÄŸiÅŸtir') {
    if (!message.member.permissions.has('ADMINISTRATOR')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu resmi deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu resmi deÄŸiÅŸtir;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Sunucu resmi deÄŸiÅŸtir;').setDescription(message.author.tag + ', kullanÄ±m: tr!sunucu-resmi-deÄŸiÅŸtir <baÄŸlantÄ±>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.guild.setIcon(sayMessage);
    const embed = new Discord.RichEmbed()
    .setColor('RANDOM')
    .setTitle('Sunucu resmi deÄŸiÅŸtir;')
    .setDescription(message.author.tag + ', sunucu resmi baÅŸarÄ±yla deÄŸiÅŸtirildi.')
    .setFooter('funish', client.user.avatarURL)
    .setTimestamp()
    message.channel.send(embed);
        };

  if (command === 'kanal-aÃ§') {
    if (!message.member.permissions.has('ADMINISTRATOR')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Kanal aÃ§;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Kanal aÃ§;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Kanal aÃ§;').setDescription(message.author.tag + ', kullanÄ±m: tr!kanal-aÃ§ <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    const channel = message.guild.createChannel(mesaj);
        };

  if (command === 'rol-oluÅŸtur') {
    if (!message.member.permissions.has('ADMINISTRATOR')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Rol oluÅŸtur;').setDescription(message.author.tag + ', bu komutu kullanmak iÃ§in gerekli izinlere sahip deÄŸilsin.').setFooter('funish', client.user.avatarURL).setTimestamp());
    if (!message.guild) {
    return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Rol oluÅŸtur;').setDescription(message.author.tag + ', bu komutu direkt mesajda kullanamazsÄ±n.').setFooter('funish', client.user.avatarURL).setTimestamp()); }
    const sayMessage = args.join(' ');
    if (sayMessage.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Rol oluÅŸtur;').setDescription(message.author.tag + ', kullanÄ±m: tr!rol-oluÅŸtur <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    message.guild.createRole({
                    name: sayMessage,
                    color: "#FF4000",
                    permission:[]
            });
    const embed = new Discord.RichEmbed()
     .setColor('RANDOM')
     .setTitle('Rol oluÅŸtur;')
     .setDescription(`BaÅŸarÄ±yla rol oluÅŸturdum!`)
     .setFooter('funish', client.user.avatarURL)
     .setTimestamp()
     message.channel.send(embed);
  }
  if(command === 'mc-sunucu') {
    const IPhere = args.join(' ');
    if (IPhere.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Minecraft sunucu;').setDescription(message.author.tag + ', kullanÄ±m: tr!mc-sunucu <sunucu IP>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    var request = require('request');
      request('https://api.mcsrvstat.us/1/' + IPhere, function (error, response, body) {
      if(error) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Minecraft sunucu;').setDescription(message.author.tag + ', bir ÅŸeyler ters gitti.').setFooter('funish', client.user.avatarURL).setTimestamp());

      var bodyJSON = JSON.parse(body)
      if(bodyJSON.debug.ping !== true) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Minecraft sunucu;').setDescription(message.author.tag + ', bu sunucu kapalÄ±.').setFooter('funish', client.user.avatarURL).setTimestamp());
      var serverIP = bodyJSON.ip
      var serverPort = bodyJSON.port
      var motd1 = bodyJSON.motd.clean[0]
      var motd2 = bodyJSON.motd.clean[1]
      if(!motd2){ 
        var motd2 = "No second line.";
      }
      var version = bodyJSON.version
      var onlinePlayers = bodyJSON.players.online
      var maxPlayers = bodyJSON.players.max
      const embed = new Discord.RichEmbed()
        .setColor('RANDOM')
        .setTitle(motd1)
        .addField('Sunucu IP:', `${serverIP}:${serverPort}`, true)
        .addField('SÃ¼rÃ¼m:', version, true)
        .addField('AÃ§Ä±klama:', `${motd1}\n${motd2}`)
        .addField('Oyuncular (Ã§evrimiÃ§i/toplam):', `${onlinePlayers}/${maxPlayers}`, true)
        .setFooter('Minecraft sunucu', client.user.avatarURL)
        .setTimestamp()
        message.channel.send({embed})
        .catch(error => message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Minecraft sunucu;').setDescription(message.author.tag + ', bir ÅŸeyler ters gitti.').setFooter('funish', client.user.avatarURL).setTimestamp()));
    });
  }
  
  if (command === 'kÄ±salt') {
    if (!args[0]) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('KÄ±salt;').setDescription(message.author.tag + ', kullanÄ±m: tr!kÄ±salt <baÄŸlantÄ±>.').setFooter('funish', client.user.avatarURL).setTimestamp());
      if (!args[1]) {
        (args[0], function(res) {
          message.channel.send(res);
        })
      } else {
        (args[0], args[1], function(res) {
          if (res.startsWith('Error')) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('KÄ±salt;').setDescription(res).setFooter('funish', client.user.avatarURL).setTimestamp());
          message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('KÄ±salt;').setDescription(`<${res}>`).setFooter('funish', client.user.avatarURL).setTimestamp());
        })
      }
  }
  if (command === 'mÃ¼zik-ara') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('MÃ¼zik ara;').setDescription(message.author.tag + ', kullanÄ±m: tr!mÃ¼zik-ara <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
    (args.join(' '))
    .then(function(results) {
    return results[0]
      })
      .then(function(result) {
      const embed = new Discord.RichEmbed()
                .setColor('RANDOM')
                .setTitle('MÃ¼zik ara;')
                .addField('MÃ¼zik adÄ±:', result.title, true)
                .addField('SanatÃ§Ä±:', result.artist, true)
                .addField('SÃ¶zler:', '[Genius]('+result.url+')', true)
                .setFooter('funish', client.user.avatarURL)
                .setTimestamp()
                message.channel.send(embed);
        });
  }
  if (command === 'youtube') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('YouTube;').setDescription(message.author.tag + ', kullanÄ±m: tr!youtube <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'YouTube',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://www.youtube.com/results?search_query=' + args.toString().replace(/,/g, '+') + ')',
      color: 0xff4000
    }
        });
  }
  if (command === 'twitter') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Twitter;').setDescription(message.author.tag + ', kullanÄ±m: tr!twitter <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'Twitter',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://twitter.com/search?q=' + args.toString().replace(/,/g, '%20') + ')',
      color: 0xff4000
    }
   })
        };
  
  if (command === 'google') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Twitter;').setDescription(message.author.tag + ', kullanÄ±m: tr!twitter <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'Google',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://google.com/search?q=' + args.toString().replace(/,/g, '%20') + ')',
      color: 0xff4000
    }
   })
        };
  
  if (command === 'instagram') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Twitter;').setDescription(message.author.tag + ', kullanÄ±m: tr!twitter <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'Ä°nstagram',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://instagram.com/' + args.toString().replace(/,/g, '%20') + ')',
      color: 0xff4000
    }
   })
        };
  
  if (command === 'github') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('GitHub;').setDescription(message.author.tag + ', kullanÄ±m: tr!github <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'GitHub',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://github.com/search?q=' + args.toString().replace(/,/g, '+') + ')',
      color: 0xff4000
    }
   })
        };
  
  if (command === 'discord-bots') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Twitter;').setDescription(message.author.tag + ', kullanÄ±m: tr!twitter <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'Discord Bots',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://discordbots.org/search?q=' + args.toString().replace(/,/g, '%20') + ')',
      color: 0xff4000
    }
   })
        };
  
    if (command === 'facebook') {
    let mesaj = args.slice(0).join(' ');
    if (mesaj.length < 1) return message.channel.send(new Discord.RichEmbed().setColor('RANDOM').setTitle('Twitter;').setDescription(message.author.tag + ', kullanÄ±m: tr!twitter <mesaj>.').setFooter('funish', client.user.avatarURL).setTimestamp());
   message.channel.send('', {
    embed: {
      type: 'rich',
      title: 'Facebook',
      description: '[' + args.toString().replace(/,/g, ' ') + '](https://facebook.com/search/top/?q=' + args.toString().replace(/,/g, '%20') + ')',
      color: 0xff4000
    }
   })
      };
      });

const snekfetch = require('snekfetch');
let points = JSON.parse(fs.readFileSync('./xp.json', 'utf8'));

var f = [];
function factorial (n) {
  if (n == 0 || n == 1)
    return 1;
  if (f[n] > 0)
    return f[n];
  return f[n] = factorial(n-1) * n;
};
  if (typeof(text) === "string")
  (/`/g, "`" + String.fromCharCode(8203)).replace(/@/g, "@" + String.fromCharCode(8203));
  else

client.on("message", async message => {
    if (message.channel.type === "dm") return;

  if (message.author.bot) return;

  var user = message.mentions.users.first() || message.author;
  if (!message.guild) user = message.author;

  if (!points[user.id]) points[user.id] = {
    points: 0,
    level: 0,
  };

  let userData = points[user.id];
  userData.points++;

  let curLevel = Math.floor(0.1 * Math.sqrt(userData.points));
  if (curLevel > userData.level) {
    userData.level = curLevel;
        var user = message.mentions.users.first() || message.author;
  message.channel.send(` **| ${user.username} level atladÄ±!**` + client.emojis.find("name", "parti").toString())
    }

fs.writeFile('./xp.json', JSON.stringify(points), (err) => {
    if (err) console.error(err)
  })

  if (message.content.toLowerCase() === prefix + 'profil' || message.content.toLowerCase() === prefix + 'profile') {
const level = new Discord.RichEmbed().setTitle(`${user.username}`).setDescription(`**Seviye:** ${userData.level}\n**GP:** ${userData.points}`).setColor("#ffff00").setFooter(``).setThumbnail(user.avatarURL)
message.channel.send(`:pencil: **| ${user.username} adlÄ± kullanÄ±cÄ±nÄ±n profil kartÄ±**`)
message.channel.send(level)
  }
});
      
client.elevation = message => {
  if(!message.guild) {
	return; }
  let permlvl = 0;
  if (message.member.hasPermission("BAN_MEMBERS")) permlvl = 2;
  if (message.member.hasPermission("ADMINISTRATOR")) permlvl = 3;
  if (message.author.id === ayarlar.sahip) permlvl = 4;
  return permlvl;
};

var regToken = /[\w\d]{24}\.[\w\d]{6}\.[\w\d-_]{27}/g;
// client.on('debug', e => {
//   console.log(chalk.bgBlue.green(e.replace(regToken, 'that was redacted')));
// });

client.on('warn', e => {
  console.log(chalk.bgYellow(e.replace(regToken, 'that was redacted')));
});

client.on('error', e => {
  console.log(chalk.bgRed(e.replace(regToken, 'that was redacted')));
});

client.login(ayarlar.token);